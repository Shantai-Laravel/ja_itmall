/*!
 * vue-nestable v2.4.5
 * (c) Ralph Huwiler <ralph@huwiler.rocks>
 * Released under the MIT License.
 */
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var __vue_normalize__=_interopDefault(require("vue-runtime-helpers/dist/normalize-component.js")),update=_interopDefault(require("immutability-helper"));function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(n,!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var store={},groupsObserver={methods:{registerNestable:function(e){var t=this._getByGroup(e.group);t.onDragStartListeners.push(e.onDragStart),t.onMouseEnterListeners.push(e.onMouseEnter),t.onMouseMoveListeners.push(e.onMouseMove)},notifyDragStart:function(e,t,n){var i=this._getByGroup(e),r=!0,o=!1,s=void 0;try{for(var a,l=i.onDragStartListeners[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){(0,a.value)(t,n)}}catch(e){o=!0,s=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw s}}},notifyMouseEnter:function(e,t,n,i){var r=this._getByGroup(e),o=!0,s=!1,a=void 0;try{for(var l,u=r.onMouseEnterListeners[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){(0,l.value)(t,n,i)}}catch(e){s=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw a}}},notifyMouseMove:function(e,t){var n=this._getByGroup(e),i=!0,r=!1,o=void 0;try{for(var s,a=n.onMouseMoveListeners[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){(0,s.value)(t)}}catch(e){r=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}},_getByGroup:function(e){return store[e]?store[e]:(store[e]={onDragStartListeners:[],onMouseEnterListeners:[],onMouseMoveListeners:[],onDragStart:[],dragItem:null},store[e])}}},script={name:"NestableItem",mixins:[groupsObserver],props:{item:{type:Object,required:!0,default:function(){return{}}},index:{type:Number,required:!1,default:null},isChild:{type:Boolean,required:!1,default:!1},isCopy:{type:Boolean,required:!1,default:!1},options:{type:Object,required:!0,default:function(){return{}}}},inject:["listId","group"],data:function(){return{breakPoint:null,moveDown:!1}},computed:{isDragging:function(){var e=this.options.dragItem;return!this.isCopy&&e&&e[this.options.keyProp]===this.item[this.options.keyProp]},hasChildren:function(){return this.item[this.options.childrenProp]&&this.item[this.options.childrenProp].length>0},hasHandle:function(){return!!this.$scopedSlots.handler},normalizedClassProp:function(){var e=this.item[this.options.classProp];return e?Array.isArray(e)?e:("undefined"==typeof a||_typeof(a),[e]):[]},itemClasses:function(){var e=this.isDragging?["is-dragging"]:[];return["nestable-item".concat(this.isCopy?"-copy":""),"nestable-item".concat(this.isCopy?"-copy":"","-").concat(this.item[this.options.keyProp])].concat(e,_toConsumableArray(this.normalizedClassProp))}},methods:{onMouseEnter:function(e){if(this.options.dragItem){if(!e.movementY)return this.sendNotification(e);this.moveDown=e.movementY>0,this.breakPoint=e.srcElement.getBoundingClientRect().height/2}},onMouseLeave:function(){this.breakPoint=null},onMouseMove:function(e){if(this.breakPoint){var t=e.offsetY-this.breakPoint;this.moveDown&&t<this.breakPoint/4||!this.moveDown&&t>-this.breakPoint/4||this.sendNotification(e)}},sendNotification:function(e){this.breakPoint=null;var t=this.item||this.$parent.item;this.notifyMouseEnter(this.group,e,this.listId,t)}}},__vue_script__=script,__vue_render__=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{class:e.itemClasses},[n("div",{staticClass:"nestable-item-content",on:{mouseenter:e.onMouseEnter,mouseleave:e.onMouseLeave,mousemove:e.onMouseMove}},[e._t("default",null,{index:e.index,item:e.item,isChild:e.isChild})],2),e._v(" "),e.hasChildren?n("ol",{staticClass:"nestable-list"},[e._l(e.item[e.options.childrenProp],function(t,i){return[n("NestableItem",{key:i,attrs:{index:i,item:t,options:e.options,"is-copy":e.isCopy,"is-child":""},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots),function(t){return{key:t,fn:function(n){return[e._t(t,null,null,n)]}}})],null,!0)})]})],2):e._e()])},__vue_staticRenderFns__=[],__vue_inject_styles__=void 0,__vue_scope_id__=void 0,__vue_module_identifier__=void 0,__vue_is_functional_template__=!1,NestableItem=__vue_normalize__({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},__vue_inject_styles__,__vue_script__,__vue_scope_id__,__vue_is_functional_template__,__vue_module_identifier__,void 0,void 0),script$1={name:"Placeholder",mixins:[groupsObserver],props:{index:{type:Number,required:!1,default:null},options:{type:Object,required:!1,default:function(){return{}}}},inject:["listId","group"],computed:{isDragging:function(){return this.options.dragItem}},methods:{onMouseEnter:function(e){this.options.dragItem&&this.notifyMouseEnter(this.group,e,this.listId,null)}}},__vue_script__$1=script$1,__vue_render__$1=function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("div",{staticClass:"nestable-list-empty",on:{mouseenter:this.onMouseEnter}},[this._t("default")],2)])},__vue_staticRenderFns__$1=[],__vue_inject_styles__$1=void 0,__vue_scope_id__$1=void 0,__vue_module_identifier__$1=void 0,__vue_is_functional_template__$1=!1,Placeholder=__vue_normalize__({render:__vue_render__$1,staticRenderFns:__vue_staticRenderFns__$1},__vue_inject_styles__$1,__vue_script__$1,__vue_scope_id__$1,__vue_is_functional_template__$1,__vue_module_identifier__$1,void 0,void 0),nestableHelpers={methods:{getPathById:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.value,i=[];return n.every(function(n,r){if(n[t.keyProp]===e)i.push(r);else if(n[t.childrenProp]){var o=t.getPathById(e,n[t.childrenProp]);o.length&&(i=i.concat(r).concat(o))}return 0===i.length}),i},getItemByPath:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.value,i=null;return e.forEach(function(e){var r=i&&i[t.childrenProp]?i[t.childrenProp]:n;i=r[e]}),i},getItemDepth:function(e){var t=1;if(e[this.childrenProp]&&e[this.childrenProp].length>0){var n=e[this.childrenProp].map(this.getItemDepth);t+=Math.max.apply(Math,_toConsumableArray(n))}return t},getSplicePath:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=t.numToRemove||0,r=t.itemsToInsert||[],o=e.length-1,s=n;return e.forEach(function(e,n){if(n===o)s.$splice=[[e,i].concat(_toConsumableArray(r))];else{var a={};s[e]=_defineProperty({},t.childrenProp,a),s=a}}),n},getRealNextPath:function(e,t){var n=e.length-1,i=t.length-1;if(e.length<t.length){var r=!1;return t.map(function(o,s){return r?s===i?o+1:o:"number"!=typeof e[s]?o:t[s]>e[s]&&s===n?(r=!0,o-1):o})}if(e.length===t.length&&t[i]>e[i]){var o=this.getItemByPath(t);if(o[this.childrenProp]&&o[this.childrenProp].length&&!this.isCollapsed(o))return t.slice(0,-1).concat(t[i]-1).concat(0)}return t}}},callsHooks={methods:{hook:function(e,t){if(!this.hooks[e])return!0;var n=this.hooks[e](t);return n||void 0===n}}},closest=function(e,t){return e.closest(t)},getOffsetRect=function(e){var t=e.getBoundingClientRect();return{top:Math.round(t.top),left:Math.round(t.left)}},getTransformProps=function(e,t){return{transform:"translate("+e+"px, "+t+"px)"}},listWithChildren=function e(t,n){return t.map(function(t){return _objectSpread2({},t,_defineProperty({},n,t[n]?e(t[n],n):[]))})},script$2={name:"VueNestable",components:{NestableItem:NestableItem,Placeholder:Placeholder},mixins:[nestableHelpers,groupsObserver,callsHooks],props:{value:{type:Array,required:!0,default:function(){return[]}},threshold:{type:Number,required:!1,default:30},maxDepth:{type:Number,required:!1,default:10},keyProp:{type:String,required:!1,default:"id"},classProp:{type:String,required:!1,default:null},group:{type:[String,Number],required:!1,default:function(){return Math.random().toString(36).slice(2)}},childrenProp:{type:String,required:!1,default:"children"},collapsed:{type:Boolean,required:!1,default:!1},hooks:{type:Object,required:!1,default:function(){return{}}}},provide:function(){return{listId:this.listId,group:this.group,onDragEnd:this.onDragEnd}},data:function(){return{itemsOld:null,dragItem:null,mouse:{last:{x:0},shift:{x:0}},el:null,elCopyStyles:null,isDirty:!1,collapsedGroups:[],listId:Math.random().toString(36).slice(2)}},computed:{listIsEmpty:function(){return 0===this.value.length},itemOptions:function(){return{dragItem:this.dragItem,keyProp:this.keyProp,classProp:this.classProp,childrenProp:this.childrenProp}},listStyles:function(){var e=document.querySelector(".nestable-"+this.group+" .nestable-item-"+this.dragItem[this.keyProp]),t={};return e&&(t.width="".concat(e.clientWidth,"px")),this.elCopyStyles&&(t=_objectSpread2({},t,{},this.elCopyStyles)),t}},created:function(){var e=listWithChildren(this.value,this.childrenProp);this.$emit("input",e),this.isDirty=!1,this.registerNestable(this)},beforeDestroy:function(){this.stopTrackMouse()},methods:{startTrackMouse:function(){document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onDragEnd),document.addEventListener("touchend",this.onDragEnd),document.addEventListener("touchcancel",this.onDragEnd),document.addEventListener("keydown",this.onKeyDown)},stopTrackMouse:function(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onDragEnd),document.removeEventListener("touchend",this.onDragEnd),document.removeEventListener("touchcancel",this.onDragEnd),document.removeEventListener("keydown",this.onKeyDown),this.elCopyStyles=null},onDragStart:function(e,t){e&&(e.preventDefault(),e.stopPropagation()),this.el=closest(e.target,".nestable-item"),this.startTrackMouse(),this.dragItem=t,this.itemsOld=this.value},onDragEnd:function(e,t){e&&e.preventDefault(),this.stopTrackMouse(),this.el=null,t?this.dragRevert():this.dragApply()},onKeyDown:function(e){27===e.which&&this.onDragEnd(null,!0)},getXandYFromEvent:function(e){var t=e.clientX,n=e.clientY,i=e.targetTouches;if(i){var r=i[0];t=r.clientX,n=r.clientY;var o=new Event("mouseenter"),s=document.elementFromPoint(t,n),a=s&&(s.closest(".nestable-item-content")||s.closest(".nestable-list-empty"));a&&a.dispatchEvent(o)}return{clientX:t,clientY:n}},onMouseMove:function(e){e&&e.preventDefault();var t=this.getXandYFromEvent(e),n=t.clientX,i=t.clientY;0===this.mouse.last.x&&(this.mouse.last.x=n);var r=getTransformProps(n,i),o=document.querySelector(".nestable-"+this.group+" .nestable-drag-layer").getBoundingClientRect(),s=o.top,a=o.left,l=document.querySelector(".nestable-"+this.group+" .nestable-drag-layer > .nestable-list");if(this.elCopyStyles){if(this.elCopyStyles=_objectSpread2({},this.elCopyStyles,{},r),l)for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(l.style[u]=r[u]);var _=n-this.mouse.last.x;_>=0&&this.mouse.shift.x>=0||_<=0&&this.mouse.shift.x<=0?this.mouse.shift.x+=_:this.mouse.shift.x=0,this.mouse.last.x=n,Math.abs(this.mouse.shift.x)>this.threshold&&(this.mouse.shift.x>0?this.tryIncreaseDepth(this.dragItem):this.tryDecreaseDepth(this.dragItem),this.mouse.shift.x=0)}else{var h=getOffsetRect(this.el);this.elCopyStyles=_objectSpread2({marginTop:"".concat(h.top-i-s,"px"),marginLeft:"".concat(h.left-n-a,"px")},r)}},moveItem:function(e){var t=e.dragItem,n=e.pathFrom,i=e.pathTo,r=this.getRealNextPath(n,i),o=this.getSplicePath(n,{numToRemove:1,childrenProp:this.childrenProp}),s=this.getSplicePath(r,{numToRemove:0,itemsToInsert:[t],childrenProp:this.childrenProp});if(this.hook("beforeMove",{dragItem:t,pathFrom:n,pathTo:r})){var a=this.value;a=update(a,o),a=update(a,s),this.isDirty=!0,this.pathTo=i,this.$emit("input",a)}},tryIncreaseDepth:function(e){var t=this.getPathById(e[this.keyProp]),n=t[t.length-1],i=t.length+this.getItemDepth(e);if(n>0&&i<=this.maxDepth){var r=this.getItemByPath(t.slice(0,-1).concat(n-1));if(r[this.childrenProp]&&(!r[this.childrenProp].length||!this.isCollapsed(r))){var o=t.slice(0,-1).concat(n-1).concat(r[this.childrenProp].length);this.moveItem({dragItem:e,pathFrom:t,pathTo:o})}}},tryDecreaseDepth:function(e){var t=this.getPathById(e[this.keyProp]),n=t[t.length-1];if(t.length>1&&n+1===this.getItemByPath(t.slice(0,-1))[this.childrenProp].length){var i=t.slice(0,-1);i[i.length-1]+=1,this.moveItem({dragItem:e,pathFrom:t,pathTo:i})}},onMouseEnter:function(e,t,n){e&&(e.preventDefault(),e.stopPropagation());var i=this.dragItem;if(i&&(null===n||i[this.keyProp]!==n[this.keyProp])){var r,o=this.getPathById(i[this.keyProp]);if(t===this.listId||0!==o.length)if(r=null===n?o.length>0?[]:[0]:this.getPathById(n[this.keyProp]),!(this.getRealNextPath(o,r).length+(this.getItemDepth(i)-1)>this.maxDepth)){var s={};if(this.collapsed&&o.length>1){var a=this.getItemByPath(o.slice(0,-1));1===a[this.childrenProp].length&&(s=this.onToggleCollapse(a,!0))}this.moveItem({dragItem:i,pathFrom:o,pathTo:r},s)}}},isCollapsed:function(e){return!!(this.collapsedGroups.indexOf(e[this.keyProp])>-1^this.collapsed)},dragApply:function(){this.$emit("change",this.dragItem,{items:this.value,pathTo:this.pathTo}),this.pathTo=null,this.itemsOld=null,this.dragItem=null,this.isDirty=!1},dragRevert:function(){this.$emit("input",this.itemsOld),this.pathTo=null,this.itemsOld=null,this.dragItem=null,this.isDirty=!1}}},__vue_script__$2=script$2,__vue_render__$2=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["nestable","nestable-"+e.group]},[n("ol",{staticClass:"nestable-list nestable-group"},[e.listIsEmpty?n("Placeholder",{attrs:{options:e.itemOptions}},[e._t("placeholder",[e._v("\n        No content\n      ")])],2):e._e(),e._v(" "),e._l(e.value,function(t,i){return[n("NestableItem",{key:i,attrs:{index:i,item:t,options:e.itemOptions},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots),function(t){return{key:t,fn:function(n){return[e._t(t,null,null,n)]}}})],null,!0)})]})],2),e._v(" "),e.dragItem?[n("div",{staticClass:"nestable-drag-layer"},[n("ol",{staticClass:"nestable-list",style:e.listStyles},[n("NestableItem",{attrs:{item:e.dragItem,options:e.itemOptions,"is-copy":!0},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots),function(t){return{key:t,fn:function(n){return[e._t(t,null,null,n)]}}})],null,!0)})],1)])]:e._e()],2)},__vue_staticRenderFns__$2=[],__vue_inject_styles__$2=void 0,__vue_scope_id__$2=void 0,__vue_module_identifier__$2=void 0,__vue_is_functional_template__$2=!1,VueNestable=__vue_normalize__({render:__vue_render__$2,staticRenderFns:__vue_staticRenderFns__$2},__vue_inject_styles__$2,__vue_script__$2,__vue_scope_id__$2,__vue_is_functional_template__$2,__vue_module_identifier__$2,void 0,void 0),script$3={name:"VueNestableHandle",mixins:[groupsObserver],props:{item:{type:Object,required:!1,default:function(){return{}}}},inject:["group","onDragEnd"],methods:{dragstart:function(e){var t=this.item||this.$parent.item;this.notifyDragStart(this.group,e,t)},touchend:function(e){this.onDragEnd(e)},touchmove:function(e){this.notifyMouseMove(this.group,e)}}},__vue_script__$3=script$3,__vue_render__$3=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"nestable-handle",attrs:{draggable:""},on:{dragstart:this.dragstart,touchstart:this.dragstart,touchend:this.touchend,touchmove:this.touchmove}},[this._t("default")],2)},__vue_staticRenderFns__$3=[],__vue_inject_styles__$3=void 0,__vue_scope_id__$3=void 0,__vue_module_identifier__$3=void 0,__vue_is_functional_template__$3=!1,VueNestableHandle=__vue_normalize__({render:__vue_render__$3,staticRenderFns:__vue_staticRenderFns__$3},__vue_inject_styles__$3,__vue_script__$3,__vue_scope_id__$3,__vue_is_functional_template__$3,__vue_module_identifier__$3,void 0,void 0),index={install:function(e,t){e.component("VueNestable",VueNestable),e.component("VueNestableHandle",VueNestableHandle)}};exports.VueNestable=VueNestable,exports.VueNestableHandle=VueNestableHandle,exports.default=index;
//# sourceMappingURL=index.min.js.map
